<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0071)http://sourceforge.net/apps/trac/openpiv/wiki/Post-processing%20options -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>
      Post-processing options – openpiv
    </title>
        <link rel="search" href="http://sourceforge.net/apps/trac/openpiv/search">
        <link rel="help" href="http://sourceforge.net/apps/trac/openpiv/wiki/TracGuide">
        <link rel="alternate" href="http://sourceforge.net/apps/trac/openpiv/wiki/Post-processing%20options?format=txt" type="text/x-trac-wiki" title="Plain Text">
        <link rel="start" href="http://sourceforge.net/apps/trac/openpiv/wiki">
        <link rel="stylesheet" href="./Post-processing options – openpiv_files/trac.css" type="text/css"><link rel="stylesheet" href="./Post-processing options – openpiv_files/wiki.css" type="text/css">
        <link rel="shortcut icon" href="http://sourceforge.net/apps/trac/openpiv/chrome/common/trac.ico" type="image/x-icon">
        <link rel="icon" href="http://sourceforge.net/apps/trac/openpiv/chrome/common/trac.ico" type="image/x-icon">
      <link type="application/opensearchdescription+xml" rel="search" href="http://sourceforge.net/apps/trac/openpiv/search/opensearch" title="Search openpiv">
    <script type="text/javascript" src="./Post-processing options – openpiv_files/jquery.js"></script><script type="text/javascript" src="./Post-processing options – openpiv_files/trac.js"></script><script type="text/javascript" src="./Post-processing options – openpiv_files/search.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/apps/trac/openpiv/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("#content").find("h1,h2,h3,h4,h5,h6").addAnchor("Link to this section");
      });
    </script>
  <link type="text/css" href="./Post-processing options – openpiv_files/default2.css" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="./Post-processing options – openpiv_files/hosted.php" media="all">

    <!-- BEGIN: AdSolution-Tag 4.2: Global-Code [PLACE IN HTML-HEAD-AREA!] -->
    <!-- DoubleClick Random Number -->
    <script type="text/javascript">
      dfp_ord=Math.random()*10000000000000000;
      dfp_tile = 1;
    </script>
	
    <!-- End DoubleClick Random Number -->
    <!-- END: AdSolution-Tag 4.2: Global-Code -->

</head>
  <body>

<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="./Post-processing options – openpiv_files/ga.js" type="text/javascript"></script>

<script type="text/javascript">
  var pageTracker = _gat._getTracker("UA-32013-36");
</script>
<div id="sf_header">
    <div class="sfh_n">
        <ol class="sfh_n_ol">
            <li class="sfh_n_li"><span><a href="http://sourceforge.net/" id="sf_logo"><strong>SourceForge</strong></a></span></li>
            <li class="sfh_n_li"><span><a href="http://sourceforge.net/projects/openpiv" title="Summary page hosted on SourceForge.net">Summary</a></span></li>
            <li class="sfh_n_li"><span><a href="http://sourceforge.net/projects/openpiv/files" title="Files available for download">Files</a></span></li>                            <li class="sfh_n_li"><span><a href="http://sourceforge.net/projects/openpiv/support">Support</a></span></li>
                        <li class="sfh_n_li"><span><a href="http://sourceforge.net/support">Report Spam</a></span></li>
                            <li class="sfh_n_li right"><span><a href="http://sourceforge.net/user/registration/" title="Get a SourceForge.net account">Create account</a></span></li>
                <li class="sfh_n_li right"><span><a href="http://sourceforge.net/account/login.php" title="Log in and gain access to additional features">Log in</a></span></li>
                    </ol>
    </div>
</div>
<div id="fad1happ" class="ads">
   <script type="text/javascript">
   //<![CDATA[
    document.write('<script src="http://ad.doubleclick.net/adj/ostg.sourceforge/cons_hosted_apps_p11_spons;pg=default;sz=728x90;tile='+dfp_tile+';tpc=project;tpc=openpiv;ord='+dfp_ord+'?" type="text/javascript"><\/script>');
     dfp_tile++;
    //]]>
    </script><script src="./Post-processing options – openpiv_files/cons_hosted_apps_p11_spons;pg=default;sz=728x90;tile=1;tpc=project;tpc=openpiv" type="text/javascript"></script><a target="_top" href="http://ad.doubleclick.net/click;h=v8/3c8e/0/0/%2a/n;44306;0-0;0;47065836;3454-728/90;0/0/0;;~okv=;pg=default;sz=728x90;tile=1;tpc=project;tpc=openpiv;~sscs=%3f"><img src="./Post-processing options – openpiv_files/817-grey.gif" border="0" alt="Click here to find out more!"></a>
</div>
    

	<div id="doc3" class="yui-t6">
		<div id="bd">
			<a name="content"></a>
<!-- End Header -->
    <div id="banner">
      <div id="header">
        <h1><a href="http://sourceforge.net/projects/openpiv/">openpiv</a></h1>
      </div>
      <form id="search" action="http://sourceforge.net/apps/trac/openpiv/search" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="">
          <input type="submit" value="Search">
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="http://sourceforge.net/apps/trac/openpiv/prefs">Preferences</a></li><li><a href="http://sourceforge.net/apps/trac/openpiv/wiki/TracGuide">Help/Guide</a></li><li class="last"><a href="http://sourceforge.net/apps/trac/openpiv/about">About Trac</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first active"><a href="http://sourceforge.net/apps/trac/openpiv/wiki">Wiki</a></li><li><a href="http://sourceforge.net/apps/trac/openpiv/timeline">Timeline</a></li><li><a href="http://sourceforge.net/apps/trac/openpiv/roadmap">Roadmap</a></li><li><a href="http://sourceforge.net/apps/trac/openpiv/browser">Browse Source</a></li><li><a href="http://sourceforge.net/apps/trac/openpiv/report">View Tickets</a></li><li class="last"><a href="http://sourceforge.net/apps/trac/openpiv/search">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
            <li class="first "><a href="http://sourceforge.net/apps/trac/openpiv/wiki/WikiStart">Start Page</a></li><li><a href="http://sourceforge.net/apps/trac/openpiv/wiki/TitleIndex">Index</a></li><li><a href="http://sourceforge.net/apps/trac/openpiv/wiki/Post-processing%20options?action=history">History</a></li><li class="last"><a href="http://sourceforge.net/apps/trac/openpiv/wiki/Post-processing%20options?action=diff&version=1">Last Change</a></li>
          </ul>
        <hr>
      </div>
    <div id="content" class="wiki">
      <div class="wikipage searchable">
        
          <h1 id="HowtoreadOpenPIVfiles">How to read OpenPIV files<a class="anchor" href="http://sourceforge.net/apps/trac/openpiv/wiki/Post-processing%20options#HowtoreadOpenPIVfiles" title="Link to this section"> ¶</a></h1>
<p>
OpenPIV files are simple ASCII files with the 5 columns:
</p>
<pre class="wiki">x, y, u, v, signal-to-noise-ratio
</pre><p>
If you're going to analyze multiple PIV files, we recommend the two options:
</p>
<ol><li>If you're <a class="ext-link" href="http://www.tsi.com/"><span class="icon">TSI</span></a> user, you have an access to our post-processing toolbox, called <a class="ext-link" href="http://www.tsi.com/en-1033/applications/spray_diagnostics/3672/insight_3g%E2%84%A2_data_acquisition,_analysis,_and_display_software.aspx"><span class="icon">SpatialBox</span></a>, developed specially for TSI's Insight 3G software in Matlab. It has pretty serious GUI options and the manual is available from TSI.
</li><li>Use free, open-source Matlab toolbox called <a class="ext-link" href="http://www.fast.u-psud.fr/pivmat/"><span class="icon">PIVMAT</span></a>
</li></ol><p>
For the option 2, we prepared a small Matlab utility function that converts OpenPIV (for Matlab and other software) files into PIVMAT compatible structure. Warning - it assumes that the proper scaling was applied during the OpenPIV run and the data is stored in mm/sec and mm units. If it's not, please, apply scaling manually by adding the lines:
</p>
<pre class="wiki">    v(i).x = unique(tmp(:,1)).'; % reshape(tmp.data(:,2),lx,ly);
    v(i).y = unique(tmp(:,2)).'; % reshape(tmp.data(:,3),lx,ly);
    v(i).vx = reshape(tmp(:,3),lx,ly);
    v(i).vy = reshape(tmp(:,4),lx,ly);
</pre><h3 id="ThefunctionloadOpenPIVTXT.m">The function <strong>loadOpenPIVTXT.m</strong><a class="anchor" href="http://sourceforge.net/apps/trac/openpiv/wiki/Post-processing%20options#ThefunctionloadOpenPIVTXT.m" title="Link to this section"> ¶</a></h3>
<pre class="wiki">function [v] = loadopenpivtxt(dirname,type)
%LOADOPENPIVTXT  Loads vector fields created by OpenPIV (www.openpiv.net)
%   software.
%
%   F = LOADOPENPIVTXT(FILENAME) loads the vector fields matching FILENAME
%   into the structure array F.
%
%   The resulting structure array F can be displayed using SHOWVEC or
%   SHOWSCAL. For multi-frame images, only the first frame is loaded. Use
%   VEC2SCAL to compute scalar fields from vector fields.
%
%   F = LOADOPENPIVTXT(DIRNAME,TYPE) loads all the vector fields matching TYPE
%   in the directory DIRNAME into the structure array F.
%   TYPE: 'raw' (or 'noflt')
%         'filtered' (or 'flt')
%         'final' (or 'txt') &lt;- default
%
%   Examples:
%           v = loadopenpivtxt('hipivdata') % reads all TXT files by default
%           v = loadopenpivtxt('.','raw')
%           v = loadopenpivtxt('.','txt')
%           v = loadopenpivtxt('hipivdata','raw')
%           v = loadopenpivtxt('hipivdata/00020359.txt') % single file
%
%   Note: When used with DaVis files, LOADVEC works only under Windows
%   32-bits edition. See VEC2MAT to convert DaVis files into Mat-files in
%   order to load them on other plateforms (Windows 64-bits, Linux, Mac...)
%
%   See also LOADVEC, SHOWVEC

%   A. Liberzon, alexlib_at_eng.tau.ac.il
%   Revision: x.xx,  Date: July 26, 2009


% default inputs
if ~nargin
    dirname = '.';
    type = 'txt';
end

% default type input
if nargin &lt; 2 | isempty(type)
    type = 'txt';
end

if exist(dirname,'file') == 2
    fileList = {dirname};
    dirname = '.';
else
    % get the fileList
    fileList = listTXTfiles(dirname,type);
end
[v] = loadtopivmatstructure(dirname,fileList)

% % make quiver of the files
% for i = 1:numel(onlyTxtFiles)
%     data = load(onlyTxtFiles{i});
%     quiver(data(:,1),data(:,2),data(:,3),data(:,4));
% end

% % if in a single file, the data is like this:
% plot(data(:,3).^2 + data(:,4).^2)
end

function [v] = loadtopivmatstructure(dirname,fileList)
wd = cd;
cd(dirname);

v = repmat(struct('x','y','vx','vy','choice','unitx','unity','namex','namey',...
    'unitvx','unitvy','namevx','namevy','pivmat_version','ysign','Attributes',...
    'name','setname','history','source'),1,length(fileList));

tmp = load(fileList{1});
x =  tmp(:,1);
y =  tmp(:,2);

lx = length(unique(x));
ly = length(unique(y));


for i = 1:length(fileList)

    % Import the file
    tmp = load(fileList{i});

    % convert into PIVMAT structure

    v(i).x = unique(tmp(:,1)).'; % reshape(tmp.data(:,2),lx,ly);
    v(i).y = unique(tmp(:,2)).'; % reshape(tmp.data(:,3),lx,ly);
    v(i).vx = reshape(tmp(:,3),lx,ly);
    v(i).vy = reshape(tmp(:,4),lx,ly);
    v(i).history = {['load_dpiv(',fileList{i},')']};
    v(i).unitx = 'mm';
    v(i).unitx = 'mm';
    v(i).unitvx = 'm/s';
    v(i).unitvx = 'm/s';
    v(i).namex = 'x';
    v(i).namey = 'y';
    v(i).namevx = 'u_x';
    v(i).namevy = 'u_y';
    v(i).setname = 'tmp';
    v(i).ysign = 'Y axis upward';
    v(i).pivmat_version = '1.80';
end
cd(wd);

end

function [fileList] = listTXTfiles(dirname,type)
% reading the files from the directory of the TYPE only
% TYPE: 'txt' or 'final'
%       'noflt' or 'raw'
%        'flt'  or 'filtered'
wd = cd;
cd(dirname);
fileList = dir('*.txt'); % list all files
fltFileList = dir('*_flt.txt'); % only filtered (before interpolation)
noFltFileList = dir('*_noflt.txt'); % only raw files (before filtering and interpolation)
% list only final files, after filtering and interpolation
switch type
    case{'txt','final'}
        fileList = setdiff(setdiff({fileList.name},{fltFileList.name}),{noFltFileList.name});
    case{'noflt','raw'}
        fileList = {noFltFileList.name};
    case{'flt','filtered'}
        fileList = {fltFileList.name};
end
cd(wd);
end
</pre><p>
Easy to use with PIVMAT, e.g. animate your flow fields by:
</p>
<pre class="wiki">showf(loadopenpivtxt('.','txt'))
</pre><p>
The output is something like:
</p>
<p>
<a style="padding:0; border:none" href="http://sourceforge.net/apps/trac/openpiv/attachment/wiki/MiscWikiFiles/readopenpivtxt.png"><img src="./Post-processing options – openpiv_files/readopenpivtxt.png" style="float:center" title="Imported from wikispaces" height="365" width="487" alt="Imported from wikispaces"></a>
</p>
<p>
Best OpenPIVing ...
</p>

        
        
      </div>
    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="last first">
          <a rel="nofollow" href="http://sourceforge.net/apps/trac/openpiv/wiki/Post-processing%20options?format=txt">Plain Text</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr>
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="./Post-processing options – openpiv_files/trac_logo_mini.png" height="30" width="107" alt="Trac Powered"></a>
      <p class="left">
        Powered by <a href="http://sourceforge.net/apps/trac/openpiv/about"><strong>Trac 0.11.2.1</strong></a><br>
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.
      </p>
      <p class="right"></p>
    </div>
<!-- Footer -->
		</div>
        </div>
<!-- End Footer -->

    
<p class="copyright">© 2012 <a title="Network which provides and promotes Open Source software downloads, development, discussion and news." href="http://geek.net/">Geeknet, Inc.</a> &nbsp; <a href="http://geek.net/terms-of-use">Terms of Use</a> - <a href="http://p.sf.net/sourceforge/privacy">Privacy Policy</a>
- <a href="http://geek.net/opt-out-choices">Cookies/Opt Out</a>
</p>
    
    <script type="text/javascript">
	pageTracker._trackPageview();
    </script>


<style id="_clearly_component__css" type="text/css">#next_pages_container { width: 5px; hight: 5px; position: absolute; top: -100px; left: -100px; z-index: 2147483647 !important; } </style><div id="_clearly_component__next_pages_container"></div><div style="display: none; " id="hiddenlpsubmitdiv"></div><script>try{for(var lastpass_iter=0; lastpass_iter < document.forms.length; lastpass_iter++){ var lastpass_f = document.forms[lastpass_iter]; if(typeof(lastpass_f.lpsubmitorig2)=="undefined"){ lastpass_f.lpsubmitorig2 = lastpass_f.submit; lastpass_f.submit = function(){ var form=this; var customEvent = document.createEvent("Event"); customEvent.initEvent("lpCustomEvent", true, true); var d = document.getElementById("hiddenlpsubmitdiv"); for(var i = 0; i < document.forms.length; i++){ if(document.forms[i]==form){ d.innerText=i; } } d.dispatchEvent(customEvent); form.lpsubmitorig2(); } } }}catch(e){}</script></body></html>